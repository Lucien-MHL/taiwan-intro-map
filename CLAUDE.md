# Taiwan Interactive Map Project - Claudeè¨˜éŒ„

## å°ˆæ¡ˆæ¦‚è¿° (Project Overview)
- **ç›®æ¨™**: å­¸ç¿’ D3.js è£½ä½œå°ç£äº’å‹•åœ°åœ–ï¼Œæ”¯æ´ç¸£å¸‚é»æ“Šç¸®æ”¾å’Œä»‹ç´¹æ–‡æ¡ˆé¡¯ç¤º
- **æŠ€è¡“æ£§**: Next.js 15 + React 19 + TypeScript + D3.js v7 + Zustand + TailwindCSS
- **åœ°åœ–è³‡æ–™**: TopoJSON æ ¼å¼ (å·²è§£æ±º GeoJSON çš„ scale å•é¡Œ)

## ç•¶å‰é–‹ç™¼ç‹€æ…‹ (Current Development Status)

### âœ… å·²å®ŒæˆåŠŸèƒ½
1. **åŸºç¤åœ°åœ–æ¸²æŸ“** - ä½¿ç”¨ TopoJSON æˆåŠŸè§£æ±ºåº§æ¨™æŠ•å½±å•é¡Œ
2. **Hover æ•ˆæœ** - æ»‘é¼ ç§»å…¥ç¸£å¸‚æ™‚é¡¯ç¤ºé’è‰²å¡«å…… (#06b6d4)
3. **é»æ“Šç¸®æ”¾åŠŸèƒ½** - é»æ“Šç¸£å¸‚å¾Œç¸®æ”¾ä¸¦é¡¯ç¤ºå°æ‡‰å…§å®¹
4. **é¸ä¸­ç‹€æ…‹ç¶­æŒ** - è§£æ±ºé¸ä¸­ç¸£å¸‚åœ¨ hover å¾Œé¡è‰²æ¶ˆå¤±çš„å•é¡Œ
5. **ç‹€æ…‹ç®¡ç†** - Zustand stores ç®¡ç†åœ°åœ–å’Œå…§å®¹ç‹€æ…‹
6. **å…§å®¹ç³»çµ±** - JSON æ ¼å¼çš„ç¸£å¸‚ä»‹ç´¹è³‡æ–™çµæ§‹

### ğŸ”§ æ ¸å¿ƒæŠ€è¡“å¯¦ä½œç´°ç¯€

#### D3.js åœ°åœ–è¨­å®š
```typescript
// æŠ•å½±è¨­å®š (å·²å„ªåŒ–)
const projection = d3
  .geoMercator()
  .scale(10000)
  .center([121, 23.5])
  .translate([width / 2, height / 2])
```

#### ç¸®æ”¾ç³»çµ±
- ç¸®æ”¾ç¯„åœ: 1-8å€
- å‹•ç•«æ™‚é–“: 750ms
- è‡ªå‹•è¨ˆç®— bounds ä¸¦ç½®ä¸­
- æ”¯æ´é›™æ“Š/ç©ºç™½å€åŸŸé‡ç½®

#### é¸ä¸­ç‹€æ…‹ç®¡ç†ï¼ˆé‡è¦è§£æ±ºæ–¹æ¡ˆï¼‰
```typescript
// å•é¡Œ: React é‡æ–°æ¸²æŸ“æœƒæ¸…é™¤ D3 è¨­ç½®çš„ styleï¼Œä¸” mouseleave äº‹ä»¶æœƒè¦†è“‹é¸ä¸­ç‹€æ…‹

// è§£æ±ºæ–¹æ¡ˆ: ä½¿ç”¨ ID + TailwindCSS çµ±ä¸€ç®¡ç†æ¨£å¼
handleCityClick: (event, feature) => {
  (event.target as SVGPathElement).setAttribute('id', 'selected')
  setSelectedCity(cityName)
}

// CSS å„ªå…ˆç´šç¢ºä¿é¸ä¸­ç‹€æ…‹ä¸è¢« hover è¦†è“‹
useEffect(() => {
  svg.select('#selected').attr('class', 
    selectedCity ? 'fill-[#06b6d4]' : 'fill-transparent'
  )
}, [selectedCity])
```

#### ç‹€æ…‹ç®¡ç†æ¶æ§‹
- `mapStore`: è™•ç†é¸ä¸­ç¸£å¸‚ã€ç¸®æ”¾ç‹€æ…‹
- `contentStore`: ç®¡ç†é¡¯ç¤ºå…§å®¹åˆ‡æ›
- **ID-based é¸ä¸­æ¨™è­˜**: é¿å… React + D3 ç‹€æ…‹è¡çª
- ä½¿ç”¨ Zustand ç¢ºä¿éŸ¿æ‡‰å¼æ›´æ–°

### ğŸ“ å°ˆæ¡ˆçµæ§‹
```
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TaiwanSvgMap.tsx     # ä¸»åœ°åœ–çµ„ä»¶
â”‚   â”œâ”€â”€ map/                 # åœ°åœ–ç›¸é—œçµ„ä»¶
â”‚   â””â”€â”€ content/             # å…§å®¹é¡¯ç¤ºçµ„ä»¶
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useMapZoom.ts        # ç¸®æ”¾é‚è¼¯ hook
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ mapStore.ts          # åœ°åœ–ç‹€æ…‹ç®¡ç†
â”‚   â””â”€â”€ contentStore.ts      # å…§å®¹ç‹€æ…‹ç®¡ç†
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ main.json           # TopoJSON åœ°åœ–è³‡æ–™
â”‚   â””â”€â”€ intros.json         # ç¸£å¸‚ä»‹ç´¹å…§å®¹
â””â”€â”€ types/
    â””â”€â”€ content.ts          # TypeScript å‹åˆ¥å®šç¾©
```

### ğŸ¯ ä¸‹ä¸€æ­¥é–‹ç™¼è¨ˆç•«

#### å„ªå…ˆç´š 1: ç­†ç¹ª Loading å‹•ç•« ğŸ¨
- [ ] å¯¦ä½œå–®ä¸€ç¸£å¸‚çš„ stroke animation proof of concept
- [ ] è¨­è¨ˆ 22 ç¸£å¸‚çš„ç¹ªè£½é †åºç­–ç•¥ï¼ˆå»ºè­°: å¤–å³¶ â†’ æœ¬å³¶è¼ªå»“ â†’ å…§éƒ¨é‚Šç•Œï¼‰
- [ ] å„ªåŒ– `getTotalLength()` å’Œ `stroke-dasharray` æ•ˆæœ
- [ ] åŠ å…¥ç­†è§¸åœé “æ•ˆæœè®“å‹•ç•«æ›´è‡ªç„¶
- [ ] æ¸¬è©¦ä¸åŒè£ç½®çš„å‹•ç•«æ•ˆèƒ½

#### å„ªå…ˆç´š 2: é€²éšåŠŸèƒ½å„ªåŒ–
- [ ] éŸ¿æ‡‰å¼è¨­è¨ˆå„ªåŒ– (æ‰‹æ©Ÿé©é…)
- [ ] å…§å®¹é¢æ¿çš„è¦–è¦ºæ”¹é€²
- [ ] é‡ç½®æŒ‰éˆ• UI å„ªåŒ–

#### å„ªå…ˆç´š 3: å¾ŒæœŸå„ªåŒ–
- [ ] ç„¡éšœç¤™è¨­è¨ˆå¯¦ä½œ
- [ ] æ•ˆèƒ½å„ªåŒ–å’Œç¨‹å¼ç¢¼é‡æ§‹
- [ ] SEO å’Œ meta æ¨™ç±¤å„ªåŒ–

### ğŸ”¥ æŠ€è¡“æŒ‘æˆ°è¨˜éŒ„
1. **GeoJSON vs TopoJSON**: èŠ±è²»ä¸€é€±æ™‚é–“è§£æ±ºåº§æ¨™ scale å•é¡Œï¼Œæœ€çµ‚ TopoJSON å®Œç¾è§£æ±º
2. **D3 + React æ•´åˆ**: ä½¿ç”¨ useRef + useEffect ç¢ºä¿ DOM æ“ä½œæ­£ç¢ºæ€§
3. **é¸ä¸­ç‹€æ…‹ç¶­æŒå•é¡Œ**: 
   - å•é¡Œ: React é‡æ–°æ¸²æŸ“æ¸…é™¤ D3 è¨­ç½®çš„ style + mouseleave äº‹ä»¶è¦†è“‹é¸ä¸­ç‹€æ…‹
   - è§£æ±º: ä½¿ç”¨ ID æ¨™è­˜ + TailwindCSS çµ±ä¸€æ¨£å¼ç®¡ç†ï¼Œé¿å… JavaScript ç‹€æ…‹ç«¶çˆ­
4. **ç‹€æ…‹åŒæ­¥**: Zustand ç¢ºä¿åœ°åœ–ç‹€æ…‹èˆ‡ UI åŒæ­¥æ›´æ–°

### ğŸš€ é–‹ç™¼æŒ‡ä»¤
- `npm run dev`: é–‹ç™¼æ¨¡å¼
- `npm run build`: å»ºç«‹ç”Ÿç”¢ç‰ˆæœ¬  
- `npm run lint`: ä»£ç¢¼æª¢æŸ¥

### ğŸ¨ Loading å‹•ç•«æŠ€è¡“è¦åŠƒ

#### æ ¸å¿ƒæŠ€è¡“æ–¹æ¡ˆ
```typescript
// SVG stroke animation åŸºç¤
const totalLength = pathElement.getTotalLength()
pathElement.style.strokeDasharray = totalLength.toString()
pathElement.style.strokeDashoffset = totalLength.toString()

// D3 transition æ§åˆ¶ç¹ªè£½
d3.select(pathElement)
  .transition()
  .duration(2000)
  .ease(d3.easeLinear)
  .style('stroke-dashoffset', 0)
```

#### ç¹ªè£½ç­–ç•¥
1. **éšæ®µæ€§ç¹ªè£½**: å¤–å³¶ â†’ æœ¬å³¶è¼ªå»“ â†’ ç¸£å¸‚é‚Šç•Œ
2. **è¦–è¦ºåœé “**: æ¯å€‹éšæ®µé–“åŠ å…¥çŸ­æš«åœé “è®“æ•ˆæœæ›´è‡ªç„¶
3. **æ•ˆèƒ½è€ƒé‡**: è¤‡é›œè·¯å¾‘å¯èƒ½éœ€è¦ç°¡åŒ–æˆ–åˆ†æ®µè™•ç†
4. **éŒ¯èª¤è™•ç†**: å‹•ç•«è¼‰å…¥å¤±æ•—çš„ fallback æ©Ÿåˆ¶

### ğŸ’¡ å‚™è¨»
- ç„¡éšœç¤™è¨­è¨ˆå°‡åœ¨å¾ŒæœŸå„ªåŒ–éšæ®µè™•ç†
- å°ˆæ¡ˆæ¡ç”¨ Prettier + ESLint ç¢ºä¿ä»£ç¢¼å“è³ª
- ä½¿ç”¨ TailwindCSS é€²è¡Œæ¨£å¼ç®¡ç†
- **é‡è¦**: hover å’Œ zoom åŠŸèƒ½å·²å®Œç¾é‹ä½œï¼Œå¯ä»¥å°ˆå¿ƒé–‹ç™¼ loading å‹•ç•«